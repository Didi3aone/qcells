function initmaps(a){_search_box=a,google.maps.event.addDomListener(window,"load",initialize())}function setlatlng(a,b){_lat=a,_lng=b}function setMapOnAll(a){for(var b=0;b<data_markers.length;b++)data_markers[b].setMap(a)}function clearMarkers(){setMapOnAll(null)}function deleteMarkers(){clearMarkers(),data_markers=[]}function getData(a,b){markers=[],$.ajax({type:"post",url:"/offices/get-data",cache:!1,data:{search:a},dataType:"json",success:function(c){if(c.datas.length>0){$(".storelist").empty();var d=0,e="http://",f="https://";$.each(c.datas,function(b,c){var g=c.address.replace(/(?:\r\n|\r|\n)/g,"<br />");if(markers[d]=[c.latitude,c.longitude,c.type],infoWindowContent[d]=['<div class="storeinfofloat" id="addressfloat">   <span class="storename" itemprop="name">'+c.name+'</span>   <span class="storecont store-add" itemprop="address">'+g+'</span>   <span class="storecont store-phone" itemprop="telephone">T : '+(c.telephone?c.telephone:"-")+'</span>   <span class="storecont store-handphone" itemprop="handphone">H : '+(c.handphone?c.handphone:"-")+'</span>   <span class="storecont store-fax" itemprop="fax">F : '+(c.fax?c.fax:"-")+"</span>"+(c.email?'   <span class="store-email" itemprop="email"><a href="mailto:'+c.email+'">'+c.email+"</a></span>":"")+(c.website?'   <span class="store-website" itemprop="website"><a target="_blank" href="'+(c.website.substr(0,e.length)!==e||c.website.substr(0,f.length)!==f?e+c.website:c.website)+'">'+c.website+"</a></span>":"")+"</div>"],""!=a){var h='<div class="store" itemscope itemtype="http://schema.org/LocalBusiness"><div class="storelink"><span class="storepic '+(2==c.type?"store-agent":"")+'" itemprop="photo"><img src="/rsc/img/ui/'+(2==c.type?"agent":"office")+'-img-placeholder.png" /></span><span class="storeinfo"><span class="storename" itemprop="name">'+c.name+'</span><span class="storecont store-add" itemprop="address">'+g+'</span><span class="storecont store-phone" itemprop="telephone">T : '+(c.telephone?c.telephone:"-")+'</span><span class="storecont store-handphone" itemprop="handphone">H : '+(c.handphone?c.handphone:"-")+'</span><span class="storecont store-fax" itemprop="fax">F : '+(c.fax?c.fax:"-")+"</span>"+(c.email?'<span class="store-email" itemprop="email"><a href="mailto:'+c.email+'">'+c.email+"</a></span>":"")+(c.website?'   <span class="store-website" itemprop="website"><a target="_blank" href="'+(c.website.substr(0,e.length)!==e||c.website.substr(0,f.length)!==f?e+c.website:c.website)+'">'+c.website+"</a></span>":"")+"</span></div></div>";$(".storelist").append(h)}d++}),c.datas.length>4&&$(".scrollbarcust").customScrollbar({updateOnWindowResize:!0})}else $(".storelist").empty(),$(".scrollbarcust").customScrollbar({updateOnWindowResize:!0});b(!0)},error:function(){}})}function getsearchdatas(){deleteMarkers(),getData(_search_box,function(a){var c;new google.maps.LatLngBounds;for(i=0;i<markers.length;i++){var d=new google.maps.LatLng(markers[i][0],markers[i][1]);1==markers[i][2]?icon="/rsc/img/ui/pin_office.png":icon="/rsc/img/ui/agen_pin_small.png";var c=new google.maps.Marker({position:d,map:map,animation:google.maps.Animation.DROP,icon:icon});google.maps.event.addListener(c,"click",function(a,b){return function(){infobox.setContent(infoWindowContent[b][0]),infobox.open(map,a),null!=a.getAnimation()?a.setAnimation(null):(a.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){a.setAnimation(null)},700))}}(c,i)),data_markers.push(c)}})}function initialize(){var a=new google.maps.LatLng("-1.7364578","117.5134753"),b={zoom:5,center:a},c=document.getElementById("gmap_object");map=new google.maps.Map(c,b),geocoder=new google.maps.Geocoder,infoWindow=new google.maps.InfoWindow,infobox=new InfoBox({disableAutoPan:!1,maxWidth:360,pixelOffset:new google.maps.Size(-140,0),zIndex:null,boxStyle:{background:"url('/rsc/img/ui/segitiga-store.png') 116px 0px no-repeat",opacity:1,width:"365px"},closeBoxMargin:"20px 10px 2px 2px;",closeBoxURL:"/rsc/img/ui/close_store_button.png",infoBoxClearance:new google.maps.Size(1,1)});var d="2.5471049",e="122.3035143";setlatlng(d,e),getsearchdatas()}var geocoder,map,marker,markers=[],data_markers=[],distance,_lat,_lng,_lat_user,_lng_user,_search_box,infoWindowContent=[],markerCluster,flag=!1,infoWindow,infobox;$("#search-box").change(function(){var a=$("#search-box").val();_search_box=a,getsearchdatas()}),$("#search-store").click(function(){var a=$("#search-box").val();_search_box=a,getsearchdatas()}),$("#clear-btn").click(function(){_search_box="",$("#search-box").val(""),getsearchdatas()});